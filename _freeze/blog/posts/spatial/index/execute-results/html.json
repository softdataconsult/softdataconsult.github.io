{
  "hash": "f71b89c0aefbad02a21dd2020fe4a03c",
  "result": {
    "markdown": "---\ntitle: \"Spatial Econometrics Data Analysis\"\ndescription: |\n  In this blog I will demonstrate how to carry out spatial data analysis using R.\ndate: \"10-10-2024\"\n#author: \"Isaac Ajao\"\n#date: \"2024-10-06\"\ncategories: [Spatial, R]\nimage: \"spatial2.png\"\n---\n\n\n\nIn this blog, I will demonstrate how I carried out Spatial Analysis of Reading \nCulture Among Higher Education Students in Southwestern Nigeria.\n\n\n### Introduction \n\n\n### Load the necessary libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(spdep)\nlibrary(splm)\nlibrary(spatialreg)\nlibrary(sp)\nlibrary(stargazer)\n```\n:::\n\n\n### Reading shape file containing the data\n\n::: {.cell}\n\n```{.r .cell-code}\n## Reading shape file containing the data\nreading = st_read(\"reading_cultre.shp\",quiet = TRUE)\nnames(reading) #show variable names\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>  [1] \"ID_0\"       \"ISO\"        \"NAME_0\"     \"ID_1\"       \"NAME_1\"    \n#>  [6] \"TYPE_1\"     \"ENGTYPE_1\"  \"NL_NAME_1\"  \"VARNAME_1\"  \"reading_hr\"\n#> [11] \"books_read\" \"cgpa\"       \"love_readi\" \"met_standa\" \"finis_book\"\n#> [16] \"long\"       \"lat\"        \"geometry\"\n```\n:::\n\n```{.r .cell-code}\nsummary(reading)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>       ID_0         ISO               NAME_0               ID_1      \n#>  Min.   :163   Length:38          Length:38          Min.   : 1.00  \n#>  1st Qu.:163   Class :character   Class :character   1st Qu.:10.25  \n#>  Median :163   Mode  :character   Mode  :character   Median :19.50  \n#>  Mean   :163                                         Mean   :19.50  \n#>  3rd Qu.:163                                         3rd Qu.:28.75  \n#>  Max.   :163                                         Max.   :38.00  \n#>     NAME_1             TYPE_1           ENGTYPE_1          NL_NAME_1        \n#>  Length:38          Length:38          Length:38          Length:38         \n#>  Class :character   Class :character   Class :character   Class :character  \n#>  Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n#>                                                                             \n#>                                                                             \n#>                                                                             \n#>   VARNAME_1           reading_hr      books_read          cgpa      \n#>  Length:38          Min.   :0.000   Min.   : 0.000   Min.   :0.000  \n#>  Class :character   1st Qu.:2.250   1st Qu.: 3.000   1st Qu.:2.962  \n#>  Mode  :character   Median :2.735   Median : 4.000   Median :3.085  \n#>                     Mean   :2.753   Mean   : 4.395   Mean   :2.904  \n#>                     3rd Qu.:3.060   3rd Qu.: 5.000   3rd Qu.:3.413  \n#>                     Max.   :6.000   Max.   :12.000   Max.   :3.930  \n#>    love_readi      met_standa      finis_book         long       \n#>  Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   : 3.474  \n#>  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.: 5.672  \n#>  Median :2.000   Median :2.000   Median :2.000   Median : 7.314  \n#>  Mean   :1.974   Mean   :1.947   Mean   :1.895   Mean   : 7.556  \n#>  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.: 8.705  \n#>  Max.   :3.000   Max.   :3.000   Max.   :3.000   Max.   :14.450  \n#>       lat                  geometry \n#>  Min.   : 4.772   MULTIPOLYGON :38  \n#>  1st Qu.: 6.525   epsg:4326    : 0  \n#>  Median : 8.089   +proj=long...: 0  \n#>  Mean   : 8.597                     \n#>  3rd Qu.:10.686                     \n#>  Max.   :13.110\n```\n:::\n\n```{.r .cell-code}\nhead(reading)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID_0\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ISO\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"NAME_0\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"ID_1\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"NAME_1\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TYPE_1\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"ENGTYPE_1\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"NL_NAME_1\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"VARNAME_1\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"reading_hr\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"books_read\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cgpa\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"love_readi\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"met_standa\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"finis_book\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"long\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lat\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"geometry\"],\"name\":[18],\"type\":[\"s_MULTIP\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"1\",\"5\":\"Abia\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"3.06\",\"11\":\"4\",\"12\":\"3.01\",\"13\":\"2\",\"14\":\"2\",\"15\":\"2\",\"16\":\"7.524533\",\"17\":\"5.456715\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"1\"},{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"2\",\"5\":\"Adamawa\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"2.06\",\"11\":\"5\",\"12\":\"2.69\",\"13\":\"3\",\"14\":\"2\",\"15\":\"2\",\"16\":\"12.400776\",\"17\":\"9.324338\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"2\"},{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"3\",\"5\":\"Akwa Ibom\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"2.20\",\"11\":\"3\",\"12\":\"3.52\",\"13\":\"2\",\"14\":\"2\",\"15\":\"2\",\"16\":\"7.846249\",\"17\":\"4.907001\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"3\"},{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"4\",\"5\":\"Anambra\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"2.66\",\"11\":\"4\",\"12\":\"3.43\",\"13\":\"2\",\"14\":\"2\",\"15\":\"2\",\"16\":\"6.935840\",\"17\":\"6.227947\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"4\"},{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"5\",\"5\":\"Bauchi\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"2.75\",\"11\":\"4\",\"12\":\"3.13\",\"13\":\"2\",\"14\":\"3\",\"15\":\"2\",\"16\":\"9.985480\",\"17\":\"10.784808\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"5\"},{\"1\":\"163\",\"2\":\"NGA\",\"3\":\"Nigeria\",\"4\":\"6\",\"5\":\"Bayelsa\",\"6\":\"State\",\"7\":\"State\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"2.25\",\"11\":\"5\",\"12\":\"2.76\",\"13\":\"3\",\"14\":\"2\",\"15\":\"2\",\"16\":\"6.072448\",\"17\":\"4.772090\",\"18\":\"<s_MULTIP>\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nplot(reading)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(reading)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"sf\"         \"data.frame\"\n```\n:::\n\n```{.r .cell-code}\nstr(reading)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Classes 'sf' and 'data.frame':\t38 obs. of  18 variables:\n#>  $ ID_0      : num  163 163 163 163 163 163 163 163 163 163 ...\n#>  $ ISO       : chr  \"NGA\" \"NGA\" \"NGA\" \"NGA\" ...\n#>  $ NAME_0    : chr  \"Nigeria\" \"Nigeria\" \"Nigeria\" \"Nigeria\" ...\n#>  $ ID_1      : num  1 2 3 4 5 6 7 8 9 10 ...\n#>  $ NAME_1    : chr  \"Abia\" \"Adamawa\" \"Akwa Ibom\" \"Anambra\" ...\n#>  $ TYPE_1    : chr  \"State\" \"State\" \"State\" \"State\" ...\n#>  $ ENGTYPE_1 : chr  \"State\" \"State\" \"State\" \"State\" ...\n#>  $ NL_NAME_1 : chr  NA NA NA NA ...\n#>  $ VARNAME_1 : chr  NA NA NA NA ...\n#>  $ reading_hr: num  3.06 2.06 2.2 2.66 2.75 2.25 3.06 2 3.5 2.42 ...\n#>  $ books_read: num  4 5 3 4 4 5 5 2 3 3 ...\n#>  $ cgpa      : num  3.01 2.69 3.52 3.43 3.13 2.76 3.13 2 3.51 3.5 ...\n#>  $ love_readi: num  2 3 2 2 2 3 2 1 2 2 ...\n#>  $ met_standa: num  2 2 2 2 3 2 2 2 2 2 ...\n#>  $ finis_book: num  2 2 2 2 2 2 2 1 2 2 ...\n#>  $ long      : num  7.52 12.4 7.85 6.94 9.99 ...\n#>  $ lat       : num  5.46 9.32 4.91 6.23 10.78 ...\n#>  $ geometry  :sfc_MULTIPOLYGON of length 38; first list element: List of 1\n#>   ..$ :List of 1\n#>   .. ..$ : num [1:302, 1:2] 7.51 7.52 7.53 7.53 7.53 ...\n#>   ..- attr(*, \"class\")= chr [1:3] \"XY\" \"MULTIPOLYGON\" \"sfg\"\n#>  - attr(*, \"sf_column\")= chr \"geometry\"\n#>  - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA NA ...\n#>   ..- attr(*, \"names\")= chr [1:17] \"ID_0\" \"ISO\" \"NAME_0\" \"ID_1\" ...\n```\n:::\n\n```{.r .cell-code}\nst_is_longlat(reading) # checking whether the geographical coordinates have been projected (the result TRUE means not) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] TRUE\n```\n:::\n\n```{.r .cell-code}\nst_crs(reading) #checking which mapping was applied\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Coordinate Reference System:\n#>   User input: WGS 84 \n#>   wkt:\n#> GEOGCRS[\"WGS 84\",\n#>     DATUM[\"World Geodetic System 1984\",\n#>         ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n#>             LENGTHUNIT[\"metre\",1]]],\n#>     PRIMEM[\"Greenwich\",0,\n#>         ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     CS[ellipsoidal,2],\n#>         AXIS[\"latitude\",north,\n#>             ORDER[1],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>         AXIS[\"longitude\",east,\n#>             ORDER[2],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     ID[\"EPSG\",4326]]\n```\n:::\n\n```{.r .cell-code}\ntable(st_is_valid(reading)) # validation\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> TRUE \n#>   38\n```\n:::\n\n```{.r .cell-code}\nreading_sp<-as(reading, \"Spatial\") \nclass(reading_sp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"SpatialPolygonsDataFrame\"\n#> attr(,\"package\")\n#> [1] \"sp\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_points<-st_cast(reading$geometry, \"MULTIPOINT\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_points_count<-sapply(reading_points, length)\nsum(reading_points_count) # Checking how many vertices are in all counties\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 401800\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_simple<-st_simplify(reading, dTolerance = 50)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_simple_points<-st_cast(reading_simple$geometry, \"MULTIPOINT\")\nsum(sapply(reading_simple_points, length))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 73496\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_central<-st_centroid(reading)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(reading))\nreading_central<-st_centroid(reading)\nplot(reading_central$geometry, add=TRUE, pch=20, col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(reading_simple) + geom_sf() + theme_bw() \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(reading_central) + geom_sf() + theme_bw() \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(reading_simple) + geom_sf(aes(fill = reading_hr)) + theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + geom_sf(data=reading_simple, aes(fill=reading_hr)) +\ngeom_sf(data=reading_central, col=\"red\") + theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + geom_sf(data=reading_simple, aes(fill=books_read)) +\ngeom_sf(data=reading_central, col=\"red\") + theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(reading)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>  [1] \"ID_0\"       \"ISO\"        \"NAME_0\"     \"ID_1\"       \"NAME_1\"    \n#>  [6] \"TYPE_1\"     \"ENGTYPE_1\"  \"NL_NAME_1\"  \"VARNAME_1\"  \"reading_hr\"\n#> [11] \"books_read\" \"cgpa\"       \"love_readi\" \"met_standa\" \"finis_book\"\n#> [16] \"long\"       \"lat\"        \"geometry\"\n```\n:::\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"reading_hr\"], \n     main = \"Spatial distn. of students' reading hour\", \n     breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"books_read\"], \n     main = \"Spatial distn. of number of books read\", \n     breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#legend(\"topright\", legend = \"books_read\", fill = topo.colors(5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf <- st_read(\"reading_cultre.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"cgpa\"], main = \"Spatial Distribution of Students' CGPA\", breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Add a legend\n#legend(\"topright\", legend = \"CGPA\", fill = topo.colors(5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"love_readi\"], \n     main = \"Spatial distn. of students who love reading\", \n     breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#legend(\"topright\", legend = \"Love reading\", fill = topo.colors(5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"met_standa\"], \n     main = \"Spatial distn. of readers who read at least 1 hour per day\", \n     breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreading_sf = st_read(\"reading_cultre.shp\") #shape file earlier created\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nplot(reading_sf[\"finis_book\"], \n     main = \"Spatial distn. of readers who finished their last book\", \n     breaks = \"quantile\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n### Six maps in one frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tmap)\n\n# Read shapefile\nreading_sf <- st_read(\"reading_cultre.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Reading layer `reading_cultre' from data source \n#>   `C:\\Users\\user\\Desktop\\softdataconsult.github.io\\blog\\posts\\spatial\\reading_cultre.shp' \n#>   using driver `ESRI Shapefile'\n#> Simple feature collection with 38 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 2.668431 ymin: 4.270418 xmax: 14.67642 ymax: 13.89201\n#> Geodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\n# Set up a 2x3 layout with tmap\ntm_layout <- tm_layout(title = c(\"Reading Hour\", \"Books Read\", \"CGPA\", \"Love Reading\", \"At least 1 hr/day\", \"Finished last book\"),\n                       frame = FALSE,\n                       asp = 0)  # Set aspect ratio to 0 for individual map customization\n\n# Plot the first map\ntm1 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"reading_hr\", title = \"Reading Hour\", style = \"quantile\")\n\n# Plot the second map\ntm2 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"books_read\", title = \"Number of Books Read\", style = \"quantile\")\n\n# Plot the third map\ntm3 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"cgpa\", title = \"CGPA\", style = \"quantile\")\n\n# Plot the fourth map\ntm4 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"love_readi\", title = \"Love Reading\", style = \"quantile\")\n\n# Plot the fifth map\ntm5 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"met_standa\", title = \"At least 1 hr/day\", style = \"quantile\")\n\n# Plot the sixth map\ntm6 <- tm_shape(reading_sf) +\n  tm_borders() +\n  tm_fill(\"finis_book\", title = \"Finished last book\", style = \"quantile\")\n\n# Display the maps in a 2x3 layout\ntmap_arrange(list(tm1, tm2, tm3, tm4, tm5, tm6), layout = tm_layout)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# read the data from excel for other analysis\nreading_data <- read.csv(\"reading_culture_coordinates.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#define our regression equation so we don't have to type it each time\nreg.eq1=reading_hr ~ books_read + cgpa + love_readi + met_standa + finis_book\nreg1=lm(reg.eq1,data=reading)\n```\n:::\n\n\n### Spatial weights matrix W\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a spatial weights matrix (queen contiguity)\nlistw <- mat2listw(matrix(rbinom(nrow(reading_data)^2, 1, 0.2), nrow(reading_data)))\n\nlistw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Characteristics of weights list object:\n#> Neighbour list object:\n#> Number of regions: 38 \n#> Number of nonzero links: 293 \n#> Percentage nonzero weights: 20.29086 \n#> Average number of links: 7.710526 \n#> Non-symmetric neighbours list\n#> \n#> Weights style: M \n#> Weights constants summary:\n#>    n   nn  S0  S1   S2\n#> M 38 1444 293 353 9516\n```\n:::\n:::\n\n\n\n### lm.morantest\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.morantest(reg1, listw )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> \tGlobal Moran I for regression residuals\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> weights: listw\n#> \n#> Moran I statistic standard deviate = 0.74448, p-value = 0.2283\n#> alternative hypothesis: greater\n#> sample estimates:\n#> Observed Moran I      Expectation         Variance \n#>      0.006178629     -0.031412369      0.002549551\n```\n:::\n:::\n\n\n\nLet's run the Four simplest models: OLS, SLX, Lag Y, and Lag Error\n\n`OLS model`\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(spdep)\nlibrary(spatialreg)\nreg1=lm(reg.eq1,data=reading)\nreg1b=lm(reading_hr ~ books_read + cgpa + love_readi + met_standa + finis_book, data=reading)\nsummary(reg1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = reg.eq1, data = reading)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -1.5992 -0.5211 -0.1218  0.1665  3.3228 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)  \n#> (Intercept)  0.07031    0.51720   0.136   0.8927  \n#> books_read   0.07339    0.08281   0.886   0.3821  \n#> cgpa         0.76432    0.33255   2.298   0.0282 *\n#> love_readi   0.30082    0.49804   0.604   0.5501  \n#> met_standa   0.53481    0.57056   0.937   0.3556  \n#> finis_book  -0.78873    0.61250  -1.288   0.2071  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.9277 on 32 degrees of freedom\n#> Multiple R-squared:  0.4904,\tAdjusted R-squared:  0.4108 \n#> F-statistic: 6.159 on 5 and 32 DF,  p-value: 0.000419\n```\n:::\n\n```{.r .cell-code}\nsummary(reg1b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = reading_hr ~ books_read + cgpa + love_readi + met_standa + \n#>     finis_book, data = reading)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -1.5992 -0.5211 -0.1218  0.1665  3.3228 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)  \n#> (Intercept)  0.07031    0.51720   0.136   0.8927  \n#> books_read   0.07339    0.08281   0.886   0.3821  \n#> cgpa         0.76432    0.33255   2.298   0.0282 *\n#> love_readi   0.30082    0.49804   0.604   0.5501  \n#> met_standa   0.53481    0.57056   0.937   0.3556  \n#> finis_book  -0.78873    0.61250  -1.288   0.2071  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.9277 on 32 degrees of freedom\n#> Multiple R-squared:  0.4904,\tAdjusted R-squared:  0.4108 \n#> F-statistic: 6.159 on 5 and 32 DF,  p-value: 0.000419\n```\n:::\n\n```{.r .cell-code}\nlm.morantest(reg1,listw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> \tGlobal Moran I for regression residuals\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> weights: listw\n#> \n#> Moran I statistic standard deviate = 0.74448, p-value = 0.2283\n#> alternative hypothesis: greater\n#> sample estimates:\n#> Observed Moran I      Expectation         Variance \n#>      0.006178629     -0.031412369      0.002549551\n```\n:::\n\n```{.r .cell-code}\n#lm.moranplot(reg1,listw1)\nlm.LMtests(reg1,listw,test=c(\"LMerr\", \"LMlag\", \"RLMerr\", \"RLMlag\", \"SARMA\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> \tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n#> \tdependence\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> test weights: listw\n#> \n#> RSerr = 0.0092842, df = 1, p-value = 0.9232\n#> \n#> \n#> \tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n#> \tdependence\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> test weights: listw\n#> \n#> RSlag = 1.4528, df = 1, p-value = 0.2281\n#> \n#> \n#> \tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n#> \tdependence\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> test weights: listw\n#> \n#> adjRSerr = 0.11628, df = 1, p-value = 0.7331\n#> \n#> \n#> \tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n#> \tdependence\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> test weights: listw\n#> \n#> adjRSlag = 1.5598, df = 1, p-value = 0.2117\n#> \n#> \n#> \tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n#> \tdependence\n#> \n#> data:  \n#> model: lm(formula = reg.eq1, data = reading)\n#> test weights: listw\n#> \n#> SARMA = 1.5691, df = 2, p-value = 0.4563\n```\n:::\n:::\n\n\n`SLX (Spatial Lag Model with Exogenous Variables)`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming your data is named 'your_data'\n# Load required packages\nlibrary(spatialreg)\n\n# Create an 'sf' object with the spatial coordinates\nreading_sf_data <- st_as_sf(reading_data, coords = c(\"long\", \"lat\"))\n\n# Create a spatial weights matrix (queen contiguity)\nlistw <- mat2listw(matrix(rbinom(nrow(reading_data)^2, 1, 0.2), nrow(reading_data)))\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}